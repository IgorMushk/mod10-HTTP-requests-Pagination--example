{"mappings":"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","sources":["src/templates/articles-infscr.hbs","src/js/news-service-infscr.js","src/index-r-infscr.js"],"sourcesContent":["{{#each this}}\n  <li>\n    <a href=\"{{url}}\" target=\"_blank\" rel=\"noopener noreferrer\">\n      <article>\n        <img src=\"{{urlToImage}}\" alt=\"\" width=\"480\">\n        <h2>{{title}}</h2>\n        <p>Posted by: {{author}}</p>\n        <p>{{description}}</p>\n      </article>\n    </a>\n  </li>\n{{/each}}","const API_KEY = 'bb47a995514a49758140b073ef1103f5';\nconst BASE_URL = 'https://newsapi.org/v2';\nconst options = {\n  headers: {\n    Authorization: API_KEY,\n  },\n};\n\nexport default class NewsApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n  }\n\n  fetchArticles() {\n    const searchParams = new URLSearchParams({\n      q: this.searchQuery,\n      language: 'en',\n      pageSize: 10,\n      page: this.page,\n    });\n    const url = `${BASE_URL}/everything?${searchParams}`;\n    // const url = `${BASE_URL}/everything?q=${this.searchQuery}&language=en&pageSize=10&page=${this.page}`;\n\n    return fetch(url, options)\n      .then(response => response.json())\n      .then(({ articles }) => articles);\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n}\n","// https://www.smashingmagazine.com/2018/01/deferring-lazy-loading-intersection-observer-api/\n\n// import './js/if';\n// import './js/io';\nimport articlesTpl from './templates/articles-infscr.hbs';\nimport NewsApiService from './js/news-service-infscr';\n\nconst refs = getRefs();\nconst newsApiService = new NewsApiService();\n\nrefs.searchForm.addEventListener('submit', onSearch);\n\nfunction onSearch(e) {\n  e.preventDefault();\n  newsApiService.query = e.currentTarget.elements.query.value;\n\n  if (newsApiService.query === '') {\n    return alert('Введи что-то нормальное');\n  }\n\n  newsApiService.resetPage();\n  clearArticlesContainer();\n  newsApiService.fetchArticles().then(articles => {\n    appendArticlesMarkup(articles);\n    newsApiService.incrementPage();\n  });\n}\n\nfunction appendArticlesMarkup(articles) {\n  refs.articlesContainer.insertAdjacentHTML('beforeend', articlesTpl(articles));\n}\n\nfunction clearArticlesContainer() {\n  refs.articlesContainer.innerHTML = '';\n}\n\nfunction getRefs() {\n  return {\n    searchForm: document.querySelector('.js-search-form'),\n    articlesContainer: document.querySelector('.js-articles-container'),\n    sentinel: document.querySelector('#sentinel'),\n  };\n}\n\nconst onEntry = entries => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting && newsApiService.query !== '') {\n      // console.log('Пора грузить еще статьи' + Date.now());\n      newsApiService.fetchArticles().then(articles => {\n        appendArticlesMarkup(articles);\n        newsApiService.incrementPage();\n      });\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(onEntry, {\n  rootMargin: '150px',\n});\nobserver.observe(refs.sentinel);\n"],"names":["$7c4965eab8b9fced$export$2e2bcd8739ae039","$parcel$interopDefault","parcelRequire","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","compiler","main","stack1","fn","program","inverse","noop","useData","$72c6b11b535eda79$var$options","headers","Authorization","$58b11f85a525e909$var$refs","searchForm","document","querySelector","articlesContainer","sentinel","$58b11f85a525e909$var$newsApiService","fetchArticles","searchParams","URLSearchParams","q","this","searchQuery","language","pageSize","page","fetch","then","response","json","articles","incrementPage","resetPage","query","newQuery","constructor","$58b11f85a525e909$var$appendArticlesMarkup","insertAdjacentHTML","addEventListener","e","preventDefault","currentTarget","elements","value","alert","innerHTML","IntersectionObserver","entries","forEach","entry","isIntersecting","rootMargin","observe"],"version":3,"file":"index-r-infscr.5aaf5022.js.map"}